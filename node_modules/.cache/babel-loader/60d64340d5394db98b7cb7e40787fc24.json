{"ast":null,"code":"var _jsxFileName = \"E:\\\\Project\\\\OUP\\\\React\\\\hackernews-react-apollo\\\\src\\\\components\\\\LinkList.js\";\nimport React, { Component } from 'react';\nimport Link from './Link';\nimport { Query } from 'react-apollo';\nimport gql from 'graphql-tag';\nexport const FEED_QUERY = gql`\n  {\n    feed {\n      links {\n        id\n        createdAt\n        url\n        description\n        postedBy {\n          id\n          name\n        }\n        votes {\n          id\n          user {\n            id\n          }\n        }\n      }\n    }\n  }\n`;\n\nclass LinkList extends Component {\n  constructor(...args) {\n    super(...args);\n\n    this._updateCacheAfterVote = (store, createVote, linkId) => {\n      const data = store.readQuery({\n        query: FEED_QUERY\n      });\n      const votedLink = data.feed.links.find(link => link.id === linkId);\n      votedLink.votes = createVote.link.votes;\n      store.writeQuery({\n        query: FEED_QUERY,\n        data\n      });\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(Query, {\n      query: FEED_QUERY,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40,\n        columnNumber: 7\n      }\n    }, ({\n      loading,\n      error,\n      data\n    }) => {\n      if (loading) return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 31\n        }\n      }, \"Fetching\");\n      if (error) return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 43,\n          columnNumber: 29\n        }\n      }, \"Error\");\n      const linksToRender = data.feed.links;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 13\n        }\n      }, linksToRender.map((link, index) => /*#__PURE__*/React.createElement(Link, {\n        key: link.id,\n        link: link,\n        index: index,\n        updateStoreAfterVote: this._updateCacheAfterVote,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 17\n        }\n      })));\n    });\n  }\n\n}\n\nexport default LinkList;","map":{"version":3,"sources":["E:/Project/OUP/React/hackernews-react-apollo/src/components/LinkList.js"],"names":["React","Component","Link","Query","gql","FEED_QUERY","LinkList","_updateCacheAfterVote","store","createVote","linkId","data","readQuery","query","votedLink","feed","links","find","link","id","votes","writeQuery","render","loading","error","linksToRender","map","index"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,IAAP,MAAiB,QAAjB;AACA,SAASC,KAAT,QAAsB,cAAtB;AACA,OAAOC,GAAP,MAAgB,aAAhB;AACA,OAAO,MAAMC,UAAU,GAAGD,GAAI;;;;;;;;;;;;;;;;;;;;;CAAvB;;AAuBP,MAAME,QAAN,SAAuBL,SAAvB,CAAiC;AAAA;AAAA;;AAAA,SAC/BM,qBAD+B,GACP,CAACC,KAAD,EAAQC,UAAR,EAAoBC,MAApB,KAA+B;AACrD,YAAMC,IAAI,GAAGH,KAAK,CAACI,SAAN,CAAgB;AAAEC,QAAAA,KAAK,EAAER;AAAT,OAAhB,CAAb;AAEA,YAAMS,SAAS,GAAGH,IAAI,CAACI,IAAL,CAAUC,KAAV,CAAgBC,IAAhB,CAAqBC,IAAI,IAAIA,IAAI,CAACC,EAAL,KAAYT,MAAzC,CAAlB;AACAI,MAAAA,SAAS,CAACM,KAAV,GAAkBX,UAAU,CAACS,IAAX,CAAgBE,KAAlC;AAEAZ,MAAAA,KAAK,CAACa,UAAN,CAAiB;AAAER,QAAAA,KAAK,EAAER,UAAT;AAAqBM,QAAAA;AAArB,OAAjB;AACD,KAR8B;AAAA;;AAU/BW,EAAAA,MAAM,GAAG;AACP,wBACE,oBAAC,KAAD;AAAO,MAAA,KAAK,EAAEjB,UAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,CAAC;AAAEkB,MAAAA,OAAF;AAAWC,MAAAA,KAAX;AAAkBb,MAAAA;AAAlB,KAAD,KAA8B;AAC7B,UAAIY,OAAJ,EAAa,oBAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAP;AACb,UAAIC,KAAJ,EAAW,oBAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAP;AAEX,YAAMC,aAAa,GAAGd,IAAI,CAACI,IAAL,CAAUC,KAAhC;AAEA,0BACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGS,aAAa,CAACC,GAAd,CAAkB,CAACR,IAAD,EAAOS,KAAP,kBACjB,oBAAC,IAAD;AACE,QAAA,GAAG,EAAET,IAAI,CAACC,EADZ;AAEE,QAAA,IAAI,EAAED,IAFR;AAGE,QAAA,KAAK,EAAES,KAHT;AAIE,QAAA,oBAAoB,EAAE,KAAKpB,qBAJ7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADD,CADH,CADF;AAYD,KAnBH,CADF;AAuBD;;AAlC8B;;AAqCjC,eAAeD,QAAf","sourcesContent":["import React, { Component } from 'react'\r\nimport Link from './Link'\r\nimport { Query } from 'react-apollo'\r\nimport gql from 'graphql-tag'\r\nexport const FEED_QUERY = gql`\r\n  {\r\n    feed {\r\n      links {\r\n        id\r\n        createdAt\r\n        url\r\n        description\r\n        postedBy {\r\n          id\r\n          name\r\n        }\r\n        votes {\r\n          id\r\n          user {\r\n            id\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nclass LinkList extends Component {\r\n  _updateCacheAfterVote = (store, createVote, linkId) => {\r\n    const data = store.readQuery({ query: FEED_QUERY })\r\n  \r\n    const votedLink = data.feed.links.find(link => link.id === linkId)\r\n    votedLink.votes = createVote.link.votes\r\n  \r\n    store.writeQuery({ query: FEED_QUERY, data })\r\n  }\r\n  \r\n  render() {\r\n    return (\r\n      <Query query={FEED_QUERY}>\r\n        {({ loading, error, data }) => {\r\n          if (loading) return <div>Fetching</div>\r\n          if (error) return <div>Error</div>\r\n\r\n          const linksToRender = data.feed.links\r\n\r\n          return (\r\n            <div>\r\n              {linksToRender.map((link, index) => (\r\n                <Link\r\n                  key={link.id}\r\n                  link={link}\r\n                  index={index}\r\n                  updateStoreAfterVote={this._updateCacheAfterVote}\r\n                />\r\n              ))}\r\n            </div>\r\n          )\r\n        }}\r\n      </Query>\r\n    )\r\n  }\r\n}\r\n\r\nexport default LinkList"]},"metadata":{},"sourceType":"module"}